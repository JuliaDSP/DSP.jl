<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Periodograms - periodogram estimation · DSP.jl</title><meta name="title" content="Periodograms - periodogram estimation · DSP.jl"/><meta property="og:title" content="Periodograms - periodogram estimation · DSP.jl"/><meta property="twitter:title" content="Periodograms - periodogram estimation · DSP.jl"/><meta name="description" content="Documentation for DSP.jl."/><meta property="og:description" content="Documentation for DSP.jl."/><meta property="twitter:description" content="Documentation for DSP.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DSP.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Submodules</span><ul><li class="is-active"><a class="tocitem" href><code>Periodograms</code> - periodogram estimation</a><ul class="internal"><li><a class="tocitem" href="#Basic-functions"><span>Basic functions</span></a></li><li><a class="tocitem" href="#Multitaper-periodogram-estimation"><span>Multitaper periodogram estimation</span></a></li><li><a class="tocitem" href="#Configuration-objects"><span>Configuration objects</span></a></li></ul></li><li><a class="tocitem" href="../estimation/"><code>Estimation</code> - parametric estimation functions</a></li><li><a class="tocitem" href="../windows/"><code>Windows</code> - window functions</a></li><li><a class="tocitem" href="../filters/"><code>Filters</code> - filter design and filtering</a></li><li><a class="tocitem" href="../util/"><code>Util</code> - utility functions</a></li><li><a class="tocitem" href="../convolutions/"><code>Convolutions</code> - similarity methods</a></li><li><a class="tocitem" href="../lpc/"><code>LPC</code> - Linear Predictive Coding</a></li></ul></li><li><a class="tocitem" href="../internals/">Internals</a></li><li><a class="tocitem" href="../appendix/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Submodules</a></li><li class="is-active"><a href><code>Periodograms</code> - periodogram estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>Periodograms</code> - periodogram estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDSP/DSP.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDSP/DSP.jl/blob/master/docs/src/periodograms.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Periodograms-periodogram-estimation"><a class="docs-heading-anchor" href="#Periodograms-periodogram-estimation"><code>Periodograms</code> - periodogram estimation</a><a id="Periodograms-periodogram-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Periodograms-periodogram-estimation" title="Permalink"></a></h1><h2 id="Basic-functions"><a class="docs-heading-anchor" href="#Basic-functions">Basic functions</a><a id="Basic-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-functions" title="Permalink"></a></h2><p>Common procedures like computing the <a href="#DSP.Periodograms.stft">short-time Fourier transform</a>, <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a>s, and <a href="#DSP.Periodograms.spectrogram"><code>spectrogram</code></a>s are documented below.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.arraysplit" href="#DSP.Periodograms.arraysplit"><code>DSP.Periodograms.arraysplit</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">arraysplit(s, n, noverlap, nfft=n, window=nothing; buffer=zeros(eltype(s), nfft))</code></pre><p>Split an array <code>s</code> into arrays of length <code>n</code> with overlapping regions of length <code>noverlap</code>.</p><p><strong>Arguments</strong></p><ul><li><code>s</code>: Input array.</li><li><code>n</code>: Specifies the required subarray length (<code>n ≤ length(s)</code>).</li><li><code>noverlap</code>: Number of overlapping elements between subarrays.</li><li><code>nfft</code>: Specifies the length of the split arrays. If <code>length(s)</code> &lt; <code>nfft</code>, then the   input is padded with zeros.</li><li><code>window</code>: An optional scaling vector to be applied to the split arrays.</li><li><code>buffer</code>: An optional buffer of length <code>nfft</code>. Iterating or indexing the returned   AbstractVector always yields the same Vector with different contents. The last result   after iteration or indexing calls is stored into buffer.</li></ul><p><strong>Returns</strong></p><p>An <a href="#DSP.Periodograms.ArraySplit"><code>ArraySplit</code></a> object with split subarrays.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; arraysplit([0.1, 0.2, 0.3, 0.4, 0.5], 3, 1)
2-element DSP.Periodograms.ArraySplit{Vector{Float64}, Float64, Nothing}:
 [0.1, 0.2, 0.3]
 [0.3, 0.4, 0.5]

julia&gt; arraysplit([0.1, 0.2, 0.3, 0.4, 0.5], 3, 2, 8)
3-element DSP.Periodograms.ArraySplit{Vector{Float64}, Float64, Nothing}:
 [0.1, 0.2, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0]
 [0.2, 0.3, 0.4, 0.0, 0.0, 0.0, 0.0, 0.0]
 [0.3, 0.4, 0.5, 0.0, 0.0, 0.0, 0.0, 0.0]

julia&gt; arraysplit([0.1, 0.2, 0.3, 0.4, 0.5], 3, 1, 3, [1, 2, 1])
2-element DSP.Periodograms.ArraySplit{Vector{Float64}, Float64, Vector{Int64}}:
 [0.1, 0.4, 0.3]
 [0.3, 0.8, 0.5]</code></pre><p>arraysplit function with buffer</p><pre><code class="language-julia-repl hljs">julia&gt; x = [1, 2, 3, 4, 5];

julia&gt; sub_arr, n_overlap, nfft = 3, 1, 3;

julia&gt; x_split = arraysplit(x, sub_arr, n_overlap, nfft, nothing; buffer=zeros(nfft));

julia&gt; x_split[2]   # Returns AbstractVector result and stores it in ArraySplit.buf and buffer
3-element Vector{Float64}:
 3.0
 4.0
 5.0

julia&gt; x_split.buf  # Returns stored results from previous x_split[2] call
3-element Vector{Float64}:
 3.0
 4.0
 5.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L75-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.ArraySplit" href="#DSP.Periodograms.ArraySplit"><code>DSP.Periodograms.ArraySplit</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ArraySplit{T&lt;:AbstractVector,S,W} &lt;: AbstractVector{Vector{S}}</code></pre><p>ArraySplit object with fields</p><ul><li><code>s::T</code></li><li><code>buf::Vector{S}</code></li><li><code>n::Int</code></li><li><code>noverlap::Int</code></li><li><code>window::W</code></li><li><code>k::Int</code></li></ul><p>where <code>buf</code>: buffer, <code>k</code>: number of split arrays, and <code>s</code>, <code>n</code>, <code>noverlap</code>, <code>window</code> are as per arguments in <a href="#DSP.Periodograms.arraysplit"><code>arraysplit</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L19-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.periodogram" href="#DSP.Periodograms.periodogram"><code>DSP.Periodograms.periodogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">periodogram(s::AbstractVector; onesided=eltype(s)&lt;:Real, nfft=nextfastfft(length(s)), fs=1, window=nothing)</code></pre><p>Computes periodogram of a 1-d signal <code>s</code> by FFT and returns a <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object.</p><p><strong>Arguments</strong></p><ul><li><code>onesided</code>: For real signals, the two-sided periodogram is symmetric and this   function returns a one-sided (real only) periodogram by default. A   two-sided periodogram can be obtained by setting <code>onesided=false</code>.</li><li><code>nfft</code>: Specifies the number of points to use for the Fourier   transform. If <code>length(s)</code> &lt; <code>nfft</code>, then the input is padded   with zeros. By default, <code>nfft</code> is the closest size for which the   Fourier transform can be computed with maximal efficiency.</li><li><code>fs</code>: The sample rate of the original signal.</li><li><code>window</code>: An optional window function or vector to be applied to the original   signal before computing the Fourier transform. The computed   periodogram is normalized so that the area under the periodogram is   equal to the uncentered variance (or average power) of the original   signal.</li></ul><p><strong>Returns</strong></p><p>A <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object with the 2 computed fields: power, freq.</p><p><strong>Examples</strong></p><p>Frequency estimate of <code>cos(2π(25)t)</code> with a 1-sided periodogram.</p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 100;                     # Sampling frequency

julia&gt; t = (1:Fs)/Fs;                # 100 time samples

julia&gt; x = cos.(2π*25*t);            # Cosine signal with 25Hz frequency

julia&gt; pxx = periodogram(x; fs=Fs);                 # Periodogram

julia&gt; _, max_index = findmax(pxx.power);           # Find index of max power

julia&gt; pxx.power[max_index], pxx.freq[max_index]    # (power, frequency)
(0.5, 25.0)</code></pre><p>2-sided periodogram of a rectangle function with Hamming window.</p><pre><code class="language-julia-repl hljs">julia&gt; x = rect(50; padding=50);     # Rectangular pulse function

julia&gt; pxx = periodogram(x; onesided=false, nfft=512, fs=1000, window=hamming);

julia&gt; round(maximum(pxx.power), digits=4)  # Expect max power to be close to 0Hz for a DC signal
0.0182</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L343-L392">source</a></section><section><div><pre><code class="language-julia hljs">periodogram(s::AbstractMatrix; nfft::NTuple{2,Int}=nextfastfft(size(s)), fs=1, radialsum=false, radialavg=false)</code></pre><p>Computes periodogram of a 2-d signal using the 2-d FFT and returns a <a href="#DSP.Periodograms.Periodogram2"><code>Periodogram2</code></a> or <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object.</p><p><strong>Arguments</strong></p><ul><li><code>nfft</code>: A 2-tuple specifying the number of points to use for the Fourier   transform for each respective dimension. If <code>size(s)</code> &lt; <code>nfft</code>, then the input is padded   with zeros. By default, <code>nfft</code> is the closest size for which the   Fourier transform can be computed with maximal efficiency.</li><li><code>fs</code>: The sample rate of the original signal in both directions.</li><li><code>radialsum</code>: For <code>radialsum=true</code>, the value of <code>power[k]</code> is proportional to   <span>$\frac{1}{N}\sum_{k\leq |k&#39;|&lt;k+1} |X[k&#39;]|^2$</span>.</li><li><code>radialavg</code>: For <code>radialavg=true</code>, the value of <code>power[k]</code> is proportional to   <span>$\frac{1}{N \#\{k\leq |k&#39;|&lt;k+1\}} \sum_{k\leq |k&#39;|&lt;k+1} |X[k&#39;]|^2$</span>.   The computation of <code>|k&#39;|</code> takes into account non-square signals   by scaling the coordinates of the wavevector accordingly.</li></ul><p><strong>Returns</strong></p><ul><li>A <a href="#DSP.Periodograms.Periodogram2"><code>Periodogram2</code></a> object by default with the 3 computed fields: power, freq1, freq2.</li><li>A <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object is returned for a radially summed or averaged periodogram   (if <code>radialsum</code> or <code>radialavg</code> is true, respectively). Only one of <code>radialsum</code>   or <code>radialavg</code> can be set to <code>true</code> in the function.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; x = [1 1; 0 1; 0 0];

julia&gt; pxx = periodogram(x; nfft=(3, 2));   # Returns Periodogram2

julia&gt; power(pxx)
3×2 Matrix{Float64}:
 1.5  0.166667
 0.5  0.166667
 0.5  0.166667

julia&gt; freq(pxx)
([0.0, 0.3333333333333333, -0.3333333333333333], [0.0, -0.5])</code></pre><p>Radial sum and radial average periodograms</p><pre><code class="language-julia-repl hljs">julia&gt; x = [1 3; 0 1];

julia&gt; periodogram(x; radialsum=true)  # Returns Periodogram
DSP.Periodograms.Periodogram{Float64, AbstractFFTs.Frequencies{Float64}, Vector{Float64}}([6.25, 4.75], [0.0, 0.5])

julia&gt; periodogram(x; radialavg=true)  # Returns Periodogram
DSP.Periodograms.Periodogram{Float64, AbstractFFTs.Frequencies{Float64}, Vector{Float64}}([6.25, 1.5833333333333333], [0.0, 0.5])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L422-L472">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.Periodogram" href="#DSP.Periodograms.Periodogram"><code>DSP.Periodograms.Periodogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Periodogram{T, F&lt;:Union{Frequencies,AbstractRange}, V&lt;:AbstractVector{T}} &lt;: TFR{T}</code></pre><p>A Periodogram object with fields:</p><ul><li><code>power::V</code></li><li><code>freq::F</code>.</li></ul><p>See <a href="#DSP.Periodograms.power"><code>power</code></a> and <a href="#DSP.Periodograms.freq"><code>freq</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L262-L269">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.Periodogram2" href="#DSP.Periodograms.Periodogram2"><code>DSP.Periodograms.Periodogram2</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Periodogram2{T, F1&lt;:Union{Frequencies,AbstractRange}, F2&lt;:Union{Frequencies,AbstractRange}, M&lt;:AbstractMatrix{T}} &lt;: TFR{T}</code></pre><p>A Periodogram2 object with fields:</p><ul><li><code>power::M</code></li><li><code>freq1::F1</code></li><li><code>freq2::F2</code></li></ul><p>See <a href="#DSP.Periodograms.power"><code>power</code></a> and <a href="#DSP.Periodograms.freq"><code>freq</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L275-L283">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.welch_pgram" href="#DSP.Periodograms.welch_pgram"><code>DSP.Periodograms.welch_pgram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">welch_pgram(s::AbstractVector, n=div(length(s), 8), noverlap=div(n, 2); onesided=eltype(s)&lt;:Real,
            nfft=nextfastfft(n), fs=1, window)</code></pre><p>Computes the Welch periodogram of a signal <code>s</code> based on segments with <code>n</code> samples with overlap of <code>noverlap</code> samples, and returns a <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object.</p><p><code>welch_pgram</code> by default divides <code>s</code> into 8 segments with 50% overlap between them. For a Bartlett periodogram, set <code>noverlap=0</code>.</p><p>See <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a> for description of optional keyword arguments.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; x = rect(10; padding=20);

julia&gt; power(welch_pgram(x; window=nothing))                    # 1-sided periodogram
2-element Vector{Float64}:
 0.9523809523809523
 0.04761904761904761

julia&gt; power(welch_pgram(x; onesided=false, window=nothing))    # 2-sided periodogram
3-element Vector{Float64}:
 0.9523809523809523
 0.023809523809523805
 0.023809523809523805


julia&gt; power(welch_pgram(x, 5; onesided=false, window=hanning)) # 5 samples segment
5-element Vector{Float64}:
 0.8888888888888888
 0.3807834425694269
 0.008105446319461968
 0.008105446319461968
 0.3807834425694269
</code></pre><p>welch_pgram with <span>$x = sin(2π(100)t) + 2sin(2π(150)t) + noise$</span></p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 1000;                         # Sampling frequency

julia&gt; t = (1:Fs)/Fs;                     # 1000 time samples

julia&gt; f = [100 150];                     # 100Hz &amp; 150Hz frequencies

julia&gt; A = [1; 2];                        # Amplitudes

julia&gt; x = sin.(2π*f.*t)*A + randn(1000); # Noise corrupted x signal

julia&gt; pxx = welch_pgram(x, 100; fs=Fs, nfft=512, window=hamming);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L595-L646">source</a></section><section><div><pre><code class="language-julia hljs">welch_pgram(s::AbstractVector, config::WelchConfig)</code></pre><p>Computes the Welch periodogram of the given signal <code>s</code> using a predefined <a href="#DSP.Periodograms.WelchConfig"><code>WelchConfig</code></a> object.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; x = rect(10; padding=20);

julia&gt; wconfig = WelchConfig(x; fs=1000, window=hamming);

julia&gt; welch_pgram(x, wconfig);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L688-L701">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.welch_pgram!" href="#DSP.Periodograms.welch_pgram!"><code>DSP.Periodograms.welch_pgram!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">welch_pgram!(out::AbstractVector, s::AbstractVector, n=div(length(s), 8),
             noverlap=div(n, 2); onesided=eltype(s)&lt;:Real, nfft=nextfastfft(n),
             fs=1, window=nothing)</code></pre><p>Computes the Welch periodogram of a signal <code>s</code>, based on segments with <code>n</code> samples with overlap of <code>noverlap</code> samples, and returns a <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a> object. The Power Spectral Density (PSD) of Welch periodogram is stored in <code>out</code>.</p><p><code>welch_pgram!</code> by default divides <code>s</code> into 8 segments with 50% overlap between them. For a Bartlett periodogram, set <code>noverlap=0</code>.</p><p>See <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a> for description of optional keyword arguments.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 100;                     # Sampling frequency

julia&gt; t = (1:Fs)/Fs;                # 100 time samples

julia&gt; x = cos.(2π*25*t);            # Cosine signal with 25Hz frequency

julia&gt; nfft = 512;

julia&gt; y = vec(zeros(1, nfft));

julia&gt; pxx = welch_pgram!(y, x, 10; onesided=false, nfft=nfft, fs=Fs);

julia&gt; y == power(pxx)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L651-L682">source</a></section><section><div><pre><code class="language-julia hljs">welch_pgram!(out::AbstractVector, s::AbstractVector, config::WelchConfig)</code></pre><p>Computes the Welch periodogram of the given signal <code>s</code>, using a predefined <a href="#DSP.Periodograms.WelchConfig"><code>WelchConfig</code></a> object. The Power Spectral Density (PSD) of Welch periodogram is stored in <code>out</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 100;                     # Sampling frequency

julia&gt; t = (1:Fs)/Fs;                # 100 time samples

julia&gt; x = cos.(2π*25*t);            # Cosine signal with 25Hz frequency

julia&gt; nfft = 512;

julia&gt; y = vec(zeros(1, nfft));

julia&gt; wconfig = WelchConfig(x; n=10, onesided=false, nfft=nfft, fs=Fs, window=hamming);

julia&gt; pxx = welch_pgram!(y, x, wconfig);

julia&gt; y == power(pxx)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L707-L733">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.spectrogram" href="#DSP.Periodograms.spectrogram"><code>DSP.Periodograms.spectrogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spectrogram(s, n=div(length(s), 8), noverlap=div(n, 2); onesided=eltype(s)&lt;:Real, nfft=nextfastfft(n), fs=1, window=nothing)</code></pre><p>Computes the spectrogram of a signal <code>s</code> based on segments with <code>n</code> samples with overlap of <code>noverlap</code> samples, and returns a <a href="#DSP.Periodograms.Spectrogram"><code>Spectrogram</code></a> object.</p><p><code>spectrogram</code> by default divides <code>s</code> into 8 segments with 50% overlap between them. See <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a> for description of optional keyword arguments.</p><p>The returned <a href="#DSP.Periodograms.Spectrogram"><code>Spectrogram</code></a> object stores the 3 computed fields: power, freq and time. See <a href="#DSP.Periodograms.power"><code>power</code></a>, <a href="#DSP.Periodograms.freq"><code>freq</code></a> and <a href="#Base.Libc.time"><code>time</code></a> for further details.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 1000;

julia&gt; t = 0:1/Fs:1-1/Fs;

julia&gt; x = sin.(2π*100*t.*t);

julia&gt; spec = spectrogram(x; fs=Fs);

julia&gt; size(power(spec))
(63, 14)

julia&gt; size(freq(spec))
(63,)

julia&gt; time(spec)
0.0625:0.063:0.8815</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L795-L827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.Spectrogram" href="#DSP.Periodograms.Spectrogram"><code>DSP.Periodograms.Spectrogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Spectrogram{T, F&lt;:Union{Frequencies,AbstractRange}, M&lt;:AbstractMatrix{T}} &lt;: TFR{T}</code></pre><p>A Spectrogram object with fields:</p><ul><li><code>power::M</code></li><li><code>freq::F</code></li><li><code>time::Float64Range</code></li></ul><p>See <a href="#DSP.Periodograms.power"><code>power</code></a>, <a href="#DSP.Periodograms.freq"><code>freq</code></a> and <a href="#Base.Libc.time"><code>time</code></a> for further details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L764-L772">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.stft" href="#DSP.Periodograms.stft"><code>DSP.Periodograms.stft</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">stft(s, n=div(length(s), 8), noverlap=div(n, 2); onesided=eltype(s)&lt;:Real, nfft=nextfastfft(n), fs=1, window=nothing)</code></pre><p>Computes the Short Time Fourier Transform (STFT) of a signal <code>s</code> based on segments with <code>n</code> samples with overlap of <code>noverlap</code> samples, and returns a matrix containing the STFT coefficients.</p><p><code>stft</code> by default divides <code>s</code> into 8 segments with 50% overlap between them. See <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a> for description of optional keyword arguments.</p><p>The STFT computes the DFT over <code>K</code> sliding windows (segments) of the signal <code>s</code>. This returns a <code>J</code> x <code>K</code> matrix where <code>J</code> is the number of DFT coefficients and <code>K</code> the number of windowed segments. The <code>k</code>th column of the returned matrix contains the DFT coefficients for the <code>k</code>th segment.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; Fs = 1000;

julia&gt; t = 0:1/Fs:5-1/Fs;

julia&gt; x = sin.(2π*t.*t);

julia&gt; size(stft(x; window=hamming))
(313, 14)

julia&gt; size(stft(x, 500, 250; onesided=false, window=hanning))
(500, 19)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L843-L871">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.freq" href="#DSP.Periodograms.freq"><code>DSP.Periodograms.freq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">freq(p)</code></pre><p>Returns the frequency bin centers for a given <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a>, <a href="#DSP.Periodograms.Spectrogram"><code>Spectrogram</code></a>, <a href="#DSP.Periodograms.CrossPowerSpectra"><code>CrossPowerSpectra</code></a>, or <a href="#DSP.Periodograms.Coherence"><code>Coherence</code></a> object.</p><p>Returns a tuple of frequency bin centers for a given <code>Periodogram2</code> object.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; freq(periodogram([1, 2, 3]; fs=210))
2-element AbstractFFTs.Frequencies{Float64}:
  0.0
 70.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L312-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.power" href="#DSP.Periodograms.power"><code>DSP.Periodograms.power</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">power(p)</code></pre><p>For a <a href="#DSP.Periodograms.Periodogram"><code>Periodogram</code></a>, returns the computed power spectral density (PSD) as a Vector.</p><p>For a <a href="#DSP.Periodograms.Spectrogram"><code>Spectrogram</code></a>, returns the computed power spectral density (PSD) at each frequency and time bin as a Matrix. Dimensions are frequency × time.</p><p>For a <a href="#DSP.Periodograms.CrossPowerSpectra"><code>CrossPowerSpectra</code></a>, returns the pairwise cross power spectral density (CPSD) between each pair of channels at each frequency. Dimensions are channel x channel x frequency.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; power(periodogram([1, 2, 3]; fs=210))
2-element Vector{Float64}:
 0.05714285714285714
 0.009523809523809525</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L290-L309">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.Libc.time" href="#Base.Libc.time"><code>Base.Libc.time</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">time(p)</code></pre><p>Returns the time bin centers for a given <a href="#DSP.Periodograms.Spectrogram"><code>Spectrogram</code></a> object.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; time(spectrogram(0:1/20:1; fs=8000))
0.000125:0.000125:0.0025</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L782-L792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.coherence" href="#DSP.Periodograms.coherence"><code>DSP.Periodograms.coherence</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">coherence(c::Coherence)</code></pre><p>Given an <code>Coherence</code> object, returns an <code>n_channels</code> x <code>n_channels</code> x <code>length(freq(c))</code> array consisting of the pairwise coherences between each channel for each frequency.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L741-L746">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.Coherence" href="#DSP.Periodograms.Coherence"><code>DSP.Periodograms.Coherence</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Coherence{T, F, A&lt;:AbstractArray{T, 3}}</code></pre><p>Holds an <code>n_channels</code> x <code>n_channels</code> x <code>length(freq)</code> array consisting of the pairwise coherences between each channel for each frequency which is accessed by <a href="#DSP.Periodograms.coherence"><code>coherence</code></a>, as well as the frequencies accessed by <a href="#DSP.Periodograms.freq"><code>freq</code></a>.</p><p>See also <a href="#DSP.Periodograms.mt_coherence"><code>mt_coherence</code></a> and <a href="#DSP.Periodograms.mt_coherence!"><code>mt_coherence!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L726-L733">source</a></section></article><h2 id="Multitaper-periodogram-estimation"><a class="docs-heading-anchor" href="#Multitaper-periodogram-estimation">Multitaper periodogram estimation</a><a id="Multitaper-periodogram-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Multitaper-periodogram-estimation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_pgram" href="#DSP.Periodograms.mt_pgram"><code>DSP.Periodograms.mt_pgram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_pgram(s; onesided=eltype(s)&lt;:Real, nfft=nextfastfft(n), fs=1, nw=4, ntapers=iceil(2nw)-1, window=dpss(length(s), nw, ntapers))
mt_pgram(signal::AbstractVector, config::MTConfig)</code></pre><p>Computes the multitaper periodogram of a signal <code>s</code>.</p><p>If <code>window</code> is not specified, the signal is tapered with <code>ntapers</code> discrete prolate spheroidal sequences with time-bandwidth product <code>nw</code>. Each sequence is equally weighted; adaptive multitaper is not (yet) supported.</p><p>If <code>window</code> is specified, each column is applied as a taper. The sum of periodograms is normalized by the total sum of squares of <code>window</code>.</p><p>Returns a <code>Periodogram</code>.</p><p>See also <a href="#DSP.Periodograms.mt_pgram!"><code>mt_pgram!</code></a> and <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L156-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_pgram!" href="#DSP.Periodograms.mt_pgram!"><code>DSP.Periodograms.mt_pgram!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_pgram!(output, s::AbstractVector{T}; onesided::Bool=eltype(s)&lt;:Real,
    nfft::Int=nextfastfft(length(s)), fs::Real=1,
    nw::Real=4, ntapers::Int=ceil(Int, 2nw)-1,
    window::Union{AbstractMatrix,Nothing}=nothing) where T&lt;:Number
mt_pgram!(output::AbstractVector, signal::AbstractVector, config::MTConfig) -&gt; Periodogram</code></pre><p>Computes a multitapered periodogram, storing the output in <code>output</code>. Arguments:</p><ul><li><code>signal::AbstractVector</code>: should be of length <code>config.n_samples</code></li><li><code>output::AbstractVector</code>: should be of length <code>length(config.freq)</code></li></ul><p>Optionally pass an <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a> object to preallocate temporary variables and choose configuration settings; otherwise, keyword arguments may be passed to choose those settings.</p><p>Returns a <code>Periodogram</code>.</p><p>See also <a href="#DSP.Periodograms.mt_pgram"><code>mt_pgram</code></a> and <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L203-L222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_spectrogram" href="#DSP.Periodograms.mt_spectrogram"><code>DSP.Periodograms.mt_spectrogram</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_spectrogram(signal::AbstractVector{T}, n::Int=length(s) &gt;&gt; 3,
                              n_overlap::Int=n &gt;&gt; 1; fs=1,
                              onesided::Bool=T &lt;: Real, kwargs...) where {T}
mt_spectrogram(signal::AbstractVector, config::MTSpectrogramConfig)</code></pre><p>Compute a multitaper spectrogram, returning a <code>Spectrogram</code> object. Optionally pass a <a href="#DSP.Periodograms.MTSpectrogramConfig"><code>MTSpectrogramConfig</code></a> object; otherwise, any additional keyword arguments accepted by <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a> may be passed to configure the tapering.</p><p>Returns a <code>Spectrogram</code>.</p><p>See also <a href="#DSP.Periodograms.mt_spectrogram!"><code>mt_spectrogram!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L341-L354">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_spectrogram!" href="#DSP.Periodograms.mt_spectrogram!"><code>DSP.Periodograms.mt_spectrogram!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_spectrogram!(output, signal::AbstractVector{T}, n::Int=length(signal) &gt;&gt; 3,
    n_overlap::Int=n &gt;&gt; 1; fs=1, onesided::Bool=T &lt;: Real, kwargs...) where {T}
mt_spectrogram!(destination::AbstractMatrix, signal::AbstractVector, config::MTSpectrogramConfig)</code></pre><p>Computes a multitaper spectrogram using the parameters specified in <code>config</code>. Arguments:</p><ul><li><code>destination</code>: <code>length(config.mt_config.freq)</code> x <code>length(config.time)</code> matrix. This can be created by <code>DSP.allocate_output(config)</code>.</li><li><code>signal</code>: vector of length <code>config.n_samples</code></li><li><code>config</code>: optionally, pass an <a href="#DSP.Periodograms.MTSpectrogramConfig"><code>MTSpectrogramConfig</code></a> object to hold temporary variables and configuration settings. Otherwise, settings arguments may be passed directly.</li></ul><p>Returns a <code>Spectrogram</code>.</p><p>See also <a href="#DSP.Periodograms.mt_spectrogram"><code>mt_spectrogram</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L288-L302">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_cross_power_spectra" href="#DSP.Periodograms.mt_cross_power_spectra"><code>DSP.Periodograms.mt_cross_power_spectra</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_cross_power_spectra(signal::AbstractMatrix{T}; fs=1, kwargs...) where {T}
mt_cross_power_spectra(signal::AbstractMatrix, config::MTCrossSpectraConfig)</code></pre><p>Computes multitapered cross power spectra between channels of a signal. Arguments:</p><ul><li><code>signal</code>: <code>n_channels</code> x <code>n_samples</code></li><li>Optionally pass an <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a> object to preallocate temporary variables</li></ul><p>and choose configuration settings. Otherwise, any keyword arguments accepted by <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a> may be passed here.</p><p>Produces a <code>CrossPowerSpectra</code> object holding the <code>n_channels</code> x <code>n_channels</code> x <code>n_frequencies</code> output array (accessed by <a href="#DSP.Periodograms.power"><code>power</code></a>) and the corresponding frequencies (accessed by <a href="#DSP.Periodograms.freq"><code>freq</code></a>).</p><p>See also <a href="#DSP.Periodograms.mt_cross_power_spectra!"><code>mt_cross_power_spectra!</code></a> and <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L623-L637">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_cross_power_spectra!" href="#DSP.Periodograms.mt_cross_power_spectra!"><code>DSP.Periodograms.mt_cross_power_spectra!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_cross_power_spectra!(output, signal::AbstractMatrix; fs=1, kwargs...)
mt_cross_power_spectra!(output, signal::AbstractMatrix, config::MTCrossSpectraConfig)</code></pre><p>Computes multitapered cross power spectra between channels of a signal. Arguments:</p><ul><li><code>output</code>: <code>n_channels</code> x <code>n_channels</code> x <code>length(config.freq)</code>. Can be created by <code>DSP.allocate_output(config)</code>.</li><li><code>signal</code>: <code>n_channels</code> x <code>n_samples</code></li><li><code>config</code>: <code>MTCrossSpectraConfig{T}</code>: optionally pass a <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a> to preallocate temporary and choose configuration settings. Otherwise, one may pass any keyword arguments accepted by this object.</li></ul><p>Produces a <code>CrossPowerSpectra</code> object holding the <code>n_channels</code> x <code>n_channels</code> x <code>n_frequencies</code> output array and the corresponding frequencies (accessed by <a href="#DSP.Periodograms.freq"><code>freq</code></a>).</p><p>See also <a href="#DSP.Periodograms.mt_cross_power_spectra"><code>mt_cross_power_spectra</code></a> and <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L525-L541">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.CrossPowerSpectra" href="#DSP.Periodograms.CrossPowerSpectra"><code>DSP.Periodograms.CrossPowerSpectra</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CrossPowerSpectra{T,F,A&lt;:AbstractArray{T, 3}}</code></pre><p>Access the cross power spectral density (an <code>n_channels</code> x <code>n_channels</code> x <code>length(freq)</code> array) via the function <a href="#DSP.Periodograms.power"><code>power</code></a>, and the frequencies by the function <a href="#DSP.Periodograms.freq"><code>freq</code></a>.</p><p>See also <a href="#DSP.Periodograms.mt_cross_power_spectra"><code>mt_cross_power_spectra</code></a> and <a href="#DSP.Periodograms.mt_cross_power_spectra!"><code>mt_cross_power_spectra!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L401-L408">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_coherence" href="#DSP.Periodograms.mt_coherence"><code>DSP.Periodograms.mt_coherence</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_coherence(signal::AbstractMatrix{T}; fs=1, freq_range = nothing, demean=false, kwargs...) where T
mt_coherence(signal::AbstractMatrix, config::MTCoherenceConfig)</code></pre><p>Arguments:</p><ul><li><code>signal</code>: <code>n_channels</code> x <code>n_samples</code> matrix</li><li>Optionally pass an <code>MTCoherenceConfig</code> to pre-allocate temporary variables and choose configuration settings, otherwise, see <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a> for the meaning of the keyword arguments.</li></ul><p>Returns a <code>Coherence</code> object.</p><p>See also <a href="#DSP.Periodograms.mt_coherence"><code>mt_coherence</code></a> and <a href="#DSP.Periodograms.MTCoherenceConfig"><code>MTCoherenceConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L792-L804">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.mt_coherence!" href="#DSP.Periodograms.mt_coherence!"><code>DSP.Periodograms.mt_coherence!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">mt_coherence!(output, signal::AbstractMatrix; fs=1, freq_range=nothing, demean=false, kwargs...)
mt_coherence!(output, signal::AbstractMatrix, config::MTCoherenceConfig)</code></pre><p>Computes the pairwise coherences between channels.</p><ul><li><code>output</code>: <code>n_channels</code> x <code>n_channels</code> matrix</li><li><code>signal</code>: <code>n_samples</code> x <code>n_channels</code> matrix</li><li><code>config</code>: optional configuration object that pre-allocates temporary variables and choose settings.</li></ul><p>Returns a <code>Coherence</code> object.</p><p>See also <a href="#DSP.Periodograms.mt_coherence"><code>mt_coherence</code></a> and <a href="#DSP.Periodograms.MTCoherenceConfig"><code>MTCoherenceConfig</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L749-L762">source</a></section></article><h2 id="Configuration-objects"><a class="docs-heading-anchor" href="#Configuration-objects">Configuration objects</a><a id="Configuration-objects-1"></a><a class="docs-heading-anchor-permalink" href="#Configuration-objects" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.WelchConfig" href="#DSP.Periodograms.WelchConfig"><code>DSP.Periodograms.WelchConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">WelchConfig(s::AbstractArray; n=size(s, ndims(s))&gt;&gt;3, noverlap=n&gt;&gt;1,
         onesided=eltype(s)&lt;:Real, nfft=nextfastfft(n),
         fs=1, window)

WelchConfig(nsamples, eltype; n=nsamples&gt;&gt;3, noverlap=n&gt;&gt;1,
         onesided=eltype&lt;:Real, nfft=nextfastfft(n),
         fs=1, window)</code></pre><p>Captures all configuration options for <a href="#DSP.Periodograms.welch_pgram"><code>welch_pgram</code></a> in a single struct (akin to <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a>). When passed on the second argument of <a href="#DSP.Periodograms.welch_pgram"><code>welch_pgram</code></a>, computes the periodogram based on segments with <code>n</code> samples with overlap of <code>noverlap</code> samples, and returns a Periodogram object. For a Bartlett periodogram, set <code>noverlap=0</code>. See <a href="#DSP.Periodograms.periodogram"><code>periodogram</code></a> for description of optional keyword arguments.</p><div class="admonition is-info" id="Note-5c63c2e0d189c14f"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-5c63c2e0d189c14f" title="Permalink"></a></header><div class="admonition-body"><p>WelchConfig precomputes an fft plan, and preallocates the necessary intermediate buffers. Thus, repeated calls to <code>welch_pgram</code> that use the same <code>WelchConfig</code> object will be more efficient than otherwise possible.</p></div></div><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; x = 1:8;

julia&gt; wconfig1 = WelchConfig(x; n=length(x), noverlap=0, window=hanning, nfft=16);

julia&gt; wconfig2 = WelchConfig(8, Float64; n=length(x), noverlap=0, window=hanning, nfft=16);</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/periodograms.jl#L530-L559">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.MTConfig" href="#DSP.Periodograms.MTConfig"><code>DSP.Periodograms.MTConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MTConfig{T}(n_samples; fs=1,
        nfft = nextpow(2, n_samples),
        window = nothing,
        nw = 4,
        ntapers = 2 * nw - 1,
        taper_weights = fill(1/ntapers, ntapers),
        onesided::Bool=T&lt;:Real,
        fft_flags = FFTW.MEASURE)</code></pre><p>Creates a config object which holds the configuration state and temporary variables used in multitaper computations, e.g. <a href="#DSP.Periodograms.mt_pgram!"><code>mt_pgram!</code></a>, <a href="#DSP.Periodograms.mt_spectrogram"><code>mt_spectrogram</code></a>, <a href="#DSP.Periodograms.MTSpectrogramConfig"><code>MTSpectrogramConfig</code></a>, <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a>, and <a href="#DSP.Periodograms.MTCoherenceConfig"><code>MTCoherenceConfig</code></a>.</p><p>An <code>MTConfig</code> can be re-used between computations as long as none of the input arguments change.</p><ul><li><code>n_samples</code>: the number of samples to be used as input when computing multitaper periodograms with this configuration. Used for pre-allocating temporary buffers.</li><li><code>fs</code>: the number of samples per second of the input signal</li><li><code>nfft</code>: length of input vector to the FFT; if <code>nfft &gt; n_samples</code>, then the input signal will be zero-padded until it is of length <code>nfft</code>.</li><li><code>window</code>: window function to use for tapering. If left at the default of <code>nothing</code>, <code>window</code> will be set to <code>dpss(n_samples, nw, ntapers)</code>.</li><li><code>ntapers</code>: the number of tapers to use.</li><li><code>taper_weights = fill(1/ntapers, ntapers)</code>: how to weight the contribution of each taper. The default setting is to simply average them.</li><li><code>onesided</code>: whether or not to compute a &quot;one-sided&quot; FFT by using that real signal data yields conjugate-symmetry in Fourier space.</li><li><code>fft_flags</code>: flags to control how the FFT plan is generated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L80-L111">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.MTSpectrogramConfig" href="#DSP.Periodograms.MTSpectrogramConfig"><code>DSP.Periodograms.MTSpectrogramConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MTSpectrogramConfig(n_samples, mt_config::MTConfig{T}, n_overlap_samples) where {T}
MTSpectrogramConfig{T}(n_samples, samples_per_window, n_overlap_samples; fs=1, kwargs...) where {T}</code></pre><p>Creates a <code>MTSpectrogramConfig</code> which holds configuration and temporary variables for <a href="#DSP.Periodograms.mt_spectrogram"><code>mt_spectrogram</code></a> and <a href="#DSP.Periodograms.mt_spectrogram!"><code>mt_spectrogram!</code></a>. Any keyword arguments accepted by <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a> may be passed here, or an <code>MTConfig</code> object itself.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L255-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.MTCrossSpectraConfig" href="#DSP.Periodograms.MTCrossSpectraConfig"><code>DSP.Periodograms.MTCrossSpectraConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MTCrossSpectraConfig{T}(n_channels, n_samples; fs=1, demean=false, freq_range=nothing,
                        ensure_aligned = T == Float32 || T == Complex{Float32}, kwargs...) where {T}
MTCrossSpectraConfig(n_channels, mt_config::MTConfig{T}; demean=false, freq_range=nothing,
                     ensure_aligned = T == Float32 || T == Complex{Float32})</code></pre><p>Creates a configuration object used for <a href="#DSP.Periodograms.mt_cross_power_spectra"><code>mt_cross_power_spectra</code></a> and <a href="#DSP.Periodograms.mt_cross_power_spectra!"><code>mt_cross_power_spectra!</code></a>.</p><ul><li><code>n_channels</code>: the number of channels of the input.</li><li><code>n_samples</code>: the number of samples for each channel of the input.</li><li><code>demean</code>: if <code>true</code>, the channelwise mean will be subtracted from the input signals before the cross spectral powers are computed.</li><li><code>freq_range</code>: if <code>nothing</code>, all frequencies are retained. Otherwise, only frequencies between <code>first(freq_range)</code> and <code>last(freq_range)</code> are retained.</li><li><code>ensure_aligned = T == Float32 || T == Complex{Float32}</code>: perform an extra copy to ensure that the FFT output is memory-aligned</li><li>Additionally, either pass an <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a> object, or keyword arguments such as <code>fs</code> accepted by <a href="#DSP.Periodograms.MTConfig"><code>MTConfig</code></a>.</li></ul><p>Returns a <code>CrossPowerSpectra</code> object.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L460-L476">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DSP.Periodograms.MTCoherenceConfig" href="#DSP.Periodograms.MTCoherenceConfig"><code>DSP.Periodograms.MTCoherenceConfig</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MTCoherenceConfig{T}(n_channels, n_samples; fs=1, demean=false, freq_range=nothing, kwargs...) where T
MTCoherenceConfig(cs_config::MTCrossSpectraConfig{T}) where {T}
MTCoherenceConfig(n_channels, mt_config::MTConfig{T}; demean=false, freq_range=nothing,
    ensure_aligned = T == Float32 || T == Complex{Float32}) where {T}</code></pre><p>Creates a configuration object for coherences from a <a href="#DSP.Periodograms.MTCrossSpectraConfig"><code>MTCrossSpectraConfig</code></a>. Provides a helper method with the same arugments as <code>MTCrossSpectraConfig</code> to construct the <code>MTCrossSpectraConfig</code> object.</p><p>See also <a href="#DSP.Periodograms.mt_coherence"><code>mt_coherence</code></a> and <a href="#DSP.Periodograms.mt_coherence!"><code>mt_coherence!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDSP/DSP.jl/blob/17b2162b04562c06b45f91635bfd715096f8f1b7/src/multitaper.jl#L661-L671">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../estimation/"><code>Estimation</code> - parametric estimation functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 12 June 2025 07:48">Thursday 12 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
